## maps

```bash
cat /proc/PID/maps
00400000-00401000 r-xp 00000000 fd:03 134244505                          /root/c/a.out
00600000-00601000 r--p 00000000 fd:03 134244505                          /root/c/a.out
00601000-00602000 rw-p 00001000 fd:03 134244505                          /root/c/a.out
7f63525f6000-7f63527ba000 r-xp 00000000 fd:03 102061354                  /usr/lib64/libc-2.17.so
7f63527ba000-7f63529b9000 ---p 001c4000 fd:03 102061354                  /usr/lib64/libc-2.17.so
7f63529b9000-7f63529bd000 r--p 001c3000 fd:03 102061354                  /usr/lib64/libc-2.17.so
7f63529bd000-7f63529bf000 rw-p 001c7000 fd:03 102061354                  /usr/lib64/libc-2.17.so
7f63529bf000-7f63529c4000 rw-p 00000000 00:00 0 
7f63529c4000-7f63529e6000 r-xp 00000000 fd:03 102061347                  /usr/lib64/ld-2.17.so
7f6352bd5000-7f6352bd8000 rw-p 00000000 00:00 0 
7f6352be4000-7f6352be5000 rw-p 00000000 00:00 0 
7f6352be5000-7f6352be6000 r--p 00021000 fd:03 102061347                  /usr/lib64/ld-2.17.so
7f6352be6000-7f6352be7000 rw-p 00022000 fd:03 102061347                  /usr/lib64/ld-2.17.so
7f6352be7000-7f6352be8000 rw-p 00000000 00:00 0 
7ffeac1dc000-7ffeac1fd000 rw-p 00000000 00:00 0                          [stack]
7ffeac1fe000-7ffeac200000 r-xp 00000000 00:00 0                          [vdso]
ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]
```

| 字段        | 解释                                             |      |
| ----------- | ------------------------------------------------ | ---- |
| Address     | 占用的起始和终止地址                             |      |
| Permissions | readable、writeable、executable、private、shared |      |
| Offset      | 指本段映射地址在文件中的偏移                     |      |
| Device      |                                                  |      |
| INode       | 对应的文件在磁盘上的inode号                      |      |
| Pathname    | 对应文件所在的路径                               |      |

## 地址空间和地址转换

| 概念         | 解释                                                         |
| ------------ | ------------------------------------------------------------ |
| 逻辑地址     | 面向程序的地址，总是从0开始编址，每一条指令的逻辑地址就是与第1条指令之间的相对偏移，因此逻辑地址也叫相对地址或虚拟地址 |
| 物理地址     | 内存单元看到的实际地址，也称为绝对地址                       |
| 逻辑地址空间 | 所有逻辑地址的集合                                           |
| 物理地址空间 | 逻辑地址对应的所有物理地址集合                               |
| 地址转换     | 将逻辑地址转换为物理地址                                     |
| MMU          | 内存管理单元，完成逻辑地址到物理地址运行时的转换             |
| 基址寄存器   | 存放进程起始物理地址，后续执行进程指令的时候，可以用逻辑地址 + 基址寄存器的值的方式，获取真实物理地址。保证进程地址的灵活性 |
| 内存碎片     |                                                              |

## 分段和分页

为什么要这些技术？

1. 为了解决碎片：允许进程的逻辑地址空间不连续
1. 内存视角的不同：逻辑上是可变大小的地址段，物理上是字节数组
1. 硬件需要提供逻辑内存到物理内存的映射

### 分段硬件

段基址、段限长、段表

段表中存储段号、段基址、段限长

### 分页

| 概念          | 解释                                            |
| ------------- | ----------------------------------------------- |
| 页page        |                                                 |
| 页框、帧frame |                                                 |
| 页号          |                                                 |
| 页内位移      |                                                 |
| 物理地址计算  | physical address = frame_no × pagesize + offset |

## 页表



