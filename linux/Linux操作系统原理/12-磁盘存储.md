## 磁盘结构

![image-20230118175139831](images/image-20230118175139831.png)

- 磁道：能被磁头访问的一组同心圆
- 扇区：磁道上的区域，数据存放的基本单位
- 柱面：所有盘片同一磁头下的磁道集合
- 恒角速度CAV
  - 不同磁道密度不同，但转速恒定
- 恒线速度CLV
  - 磁道密度相同，但转速不断变化

![image-20230118175225517](images/image-20230118175225517.png)

![image-20230118175243782](images/image-20230118175243782.png)

![image-20230118175254710](images/image-20230118175254710.png)

## 磁盘格式化

低级格式化（Low-level formatting）

- Physical formatting
- 为每个扇区使用特殊的数据结构进行填充，包括一个头部、数据区域和一个尾部。
- 头部和尾部包含一些控制信息，如扇区号、ECC码等。

高级格式化（High-level formatting）

- Logical formatting
- 构建文件系统，在磁盘上初始化文件系统数据结构，如空闲和已分配空间表、一个空目录等。

## 磁盘性能

### 磁盘性能指标

查找一个物理块的顺序：柱面号、磁头号和扇区号

- 寻道时间Ts：将磁头定位到正确磁道(柱面)上所花的时间，与盘片直径和传动臂速度相关，平均20ms。
- 旋转延迟Tr：所查找的扇区转到磁头下所用的时间，与磁盘的旋转速度有关，一个10,000 r/m的磁盘平均旋转延迟为3ms
- 传送时间T：传送扇区内的数据的时间，同样取决于磁盘的旋转速度，T = b/(rN) (b为要传送的字节数，N为一个磁道中的字节数，r为转速)

总的平均存取时间 Ta = Ts + Tr + T

### 实例分析

- 条件假设
  - 平均寻道时间为 5 ms，平均旋转延迟为 4 ms
  - 传输速率为 4 MByte/s，扇区大小是 1 KByte
- 如果随机访问一个扇区
  - Ta = 5ms + 4ms + 0.25ms ≈ 10 ms
  - 总的存取速率为100 KByte/sec
- 如果要访问的扇区在同一个柱面
  - Ta = 4ms + 0.25ms ≈ 5 ms → 200 KByte/sec
- 如果下一个要访问的扇区正好和上次访问的扇区相邻
  - Ta = 0.25ms → 4 MByte/sec